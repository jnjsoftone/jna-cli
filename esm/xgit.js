#!/usr/bin/env node
import{Octokit as e}from"@octokit/rest";import o from"yargs";import{findAllRepos as i,findGithubAccount as a,createRemoteRepo as r,setLocalConfig as t,cloneRepo as s,initLocalRepo as p,deleteRemoteRepo as c,initRepo as n,copyRepo as m,pushRepo as l,makeRepo as d,removeRepo as R}from"./git.js";import{getCurrentDir as u}from"./cli.js";let N=o.usage("Usage: -e <exec> -u <userName> -n <repoName> -d <description> -p <isPrivate>").option("e",{alias:"exec",default:"copyRepo",describe:"exec command copyRepo(clone+local config)/makeRepo(create remote+push)/removeRepo(delete remote+local)",type:"string",demandOption:!0}).option("u",{alias:"userName",default:"mooninlearn",describe:"Name of User",type:"string"}).option("n",{alias:"repoName",describe:"NameOfRepository",type:"string"}).option("p",{alias:"isPrivate",default:!1,describe:"Private Repository",type:"boolean"}).option("s",{alias:"src",default:"local",describe:"Source of Github Account",type:"string"}).option("d",{alias:"description",describe:"Description For Repository",type:"string"}).argv;(async()=>{try{var o;let b,g;let y=await a(N.userName??"","github");y.userName=N.userName??"";let v=new e({auth:y.token}),f=(o=N.repoName??"",(g=u()).split("/").pop()!==o&&(g+=`/${o}`),g??"");switch(N.exec){case"listRepos":try{b=await i(v),console.log(JSON.stringify(b,null,2))}catch(e){console.error("저장소 목록 조회 중 오류 발생:",e)}break;case"createRemoteRepo":console.log(`createRemoteRepo: ${N}`),await r(v,{name:N.repoName??"",description:N.description??"",isPrivate:N.isPrivate??!1});break;case"deleteRemoteRepo":await c(v,{name:N.repoName??""},y);break;case"setLocalConfig":t({name:N.repoName??"",description:N.description??""},y,f);break;case"cloneRepo":s({name:N.repoName??"",description:N.description??""},y,f);break;case"initLocalRepo":p({name:N.repoName??"",description:N.description??""},y,f);break;case"initRepo":console.log("====initRepo"),await n(v,{name:N.repoName??"",description:N.description??"",isPrivate:N.isPrivate??!1},y,f);break;case"pushRepo":l({name:N.repoName??"",description:N.description??""},y,f);break;case"copyRepo":m({name:N.repoName??"",description:N.description??"description",isPrivate:N.isPrivate??!1},y,f);break;case"makeRepo":await d(v,{name:N.repoName??"",description:N.description??"",isPrivate:N.isPrivate??!1},y,f);break;case"removeRepo":await R(v,{name:N.repoName??""},y,f)}}catch(e){console.error("Error:",e),process.exit(1)}})();